'use strict';

const fs = require('fs');
const logger = require('dachshund-logger').getLogger(__filename);
const PROPERTIES_FILE_NAME = ".properties.json";

var nodeProperties = exports;

nodeProperties.load = function(resourcePath) {
	var properties = {};

	var nodePropertiesPath = "." + resourcePath + "/" + PROPERTIES_FILE_NAME;

	if (fs.existsSync(nodePropertiesPath))
	{
		var propertyFileData = fs.readFileSync(nodePropertiesPath, 'utf8');
		try
		{
			properties = JSON.parse(propertyFileData);
		} catch (err)
		{
			logger.error("Error while parsing node properties '" + nodePropertiesPath + "'. " + err);
		}
	}

	return properties;
};

nodeProperties.save = function(resourcePath, properties) {
	var nodePropertiesPath = "." + resourcePath + "/" + PROPERTIES_FILE_NAME;
	properties.timeLastChange = new Date();

	var propertyFileData = JSON.stringify(properties);

	fs.writeFileSync(nodePropertiesPath, propertyFileData, 'utf8');
};
